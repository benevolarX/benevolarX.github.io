<!DOCTYPE html><html lang="fr" class="astro-62YOCVTG">
	<head>
		<meta charset="UTF-8">
<meta name="description" property="og:description" content="Framework css personnel sans js
">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Astro v1.1.3">
<title>get-ip-from-request</title>

<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@200;400;700;900&display=swap" rel="stylesheet">

		
	<link rel="stylesheet" href="/assets/404-about-index-project-b-css-project-get-ip-from-request-projects.ceac8769.css" />
<link rel="stylesheet" href="/assets/index-project-b-css-project-get-ip-from-request-projects.67374c17.css" /></head>
	<body class="astro-62YOCVTG">
		<nav data-hk="0-0" class="_nav_ycrok_1"><a class="_logolink_ycrok_10" href="/"><div class="_monogram_ycrok_30">B</div></a><a class="_link_ycrok_16" href="/projects">Projets</a><a class="_link_ycrok_16" href="/about">A propos</a><a class="_social_ycrok_47" href="https://twitter.com/me"><svg class="_socialicon_ycrok_55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z"></path></svg></a><a class="_social_ycrok_47" href="https://github.com/me"><svg class="_socialicon_ycrok_55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg></a><a class="_social_ycrok_47" href="https://dev.to/me"><svg class="_socialicon_ycrok_55" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 40" style="enable-background:new 0 0 50 40"><path d="M15.7 15.5c-.4-.3-.7-.4-1.1-.4h-1.7v10.1h1.7c.4 0 .8-.1 1.1-.4.4-.3.6-.7.6-1.3v-6.7c0-.6-.2-1-.6-1.3z"></path><path d="M47 0H3C1.3 0 0 1.3 0 3v34c0 1.7 1.3 3 3 3h44c1.7 0 3-1.3 3-3V3c0-1.7-1.3-3-3-3zM19.1 23.5c0 1.3-.4 2.4-1.3 3.2-.8.9-1.9 1.3-3.3 1.3h-4.4V12.3h4.5c1.3 0 2.4.4 3.2 1.3.8.8 1.3 1.9 1.3 3.2v6.7zm9.1-8.4h-5.1v3.6h3.1v2.8h-3.1v3.7h5.1V28h-5.9c-.6 0-1-.2-1.4-.6-.4-.4-.6-.8-.6-1.4V14.2c0-.6.2-1 .6-1.4.4-.4.8-.6 1.4-.6h5.9v2.9zM37.5 26c-.6 1.3-1.3 2-2.2 2-.9 0-1.7-.7-2.2-2l-3.7-13.8h3.1L35.3 23l2.8-10.8h3.1L37.5 26z"></path></svg></a></nav>
		<header style="background-image:url(https://images.unsplash.com/photo-1548391350-1a529f6ea42d?fit=crop&#38;w=1400&#38;h=700&#38;q=75)" class="hero astro-62YOCVTG">
			<h1 class="title astro-62YOCVTG">get-ip-from-request</h1>
		</header>
		<div class="leadIn astro-62YOCVTG">
			<div class="wrapper pt8 pb8 mb8 tac astro-62YOCVTG">
				<span class="tag astro-62YOCVTG">ip</span><span class="tag astro-62YOCVTG">back</span><span class="tag astro-62YOCVTG">unit-test</span><span class="tag astro-62YOCVTG">npm</span>
				<h3 class="tagline astro-62YOCVTG">Framework css personnel sans js
</h3>
			</div>
		</div>
		<div class="wrapper wrapper__readable astro-62YOCVTG">
			<div class="content astro-62YOCVTG"><p>Alors lÃ , on attaque un gros morceau.
Ne vous fiez pas au <a href="https://github.com/benevolarX/get-ip-from-request">repo github</a>, le projet a bel et bien Ã©tÃ© publiÃ© en 2020.
A la base, je travaillais sur un projet back et je souhaitais rÃ©cupÃ©rer lâ€™ip de lâ€™utilisateur ainsi que le numÃ©ro de version de son navigateur (User Agent) afin dâ€™avoir une emprunt numÃ©rique assez fiable pour lâ€™identifier sans que celui ci nâ€™ai besoin de crÃ©er un compte utilisateur.
Rapidement, je suis tombÃ© sur <a href="https://www.npmjs.com/package/request-ip">request-ip</a>.</p>
<p>En regardant le code (en version 2.1.3 Ã  lâ€™Ã©poque) jâ€™ai trouvÃ© un truc que jâ€™ai trouvÃ© dommage : une dÃ©pendance Ã  is_js en nâ€™important que la fonction permettant de tester lâ€™ip via une expression rÃ©guliÃ¨re.
ParallÃ¨lement, je suis aussi tombÃ© sur is-ip qui mâ€™a ensuite redirigÃ© sur <a href="https://www.npmjs.com/package/ip-regex">ip-regex</a>.
Câ€™est lâ€™un des gros points noirs de node js et ces paquets npm.
Souvent les gens tÃ©lÃ©chargent une dÃ©pendance juste pour une fonction populaire au lieu de la crÃ©er eux mÃªme et si la dÃ©pendance part Ã  lâ€™abbandon et bien temps pi pour vous.</p>
<p>En mâ€™inspirant de ceux deux lÃ , jâ€™ai crÃ©Ã© ma propre lib get-ip-from-request (le nom est un peut long je sais) afin de rÃ©aliser la mÃªme tÃ¢che que request-ip MAIS avec une regex personnelle inspirÃ©e de ip-regex.
AprÃ¨s quelques tests (unitaires repris dâ€™autres libs de test dâ€™ip) jâ€™ai pu me rendre compte que ma version 0-dependancy Ã©tait plus rapide (jusquâ€™Ã  40% plus rapide pour lâ€™ip v4-v6 par rapport Ã  is_js qui Ã©tait utilisÃ© par request-ip)
Jâ€™Ã©tais tout fier au moment oÃ¹ jâ€™ai publiÃ© mes rÃ©sultats surtout que jâ€™avais un ryzen 3 1300x donc un processeur 4 coeurs; trÃ¨s loin de pouvoir rivaliser avec les processeurs de serveur web.</p>
<p>Jâ€™ai maintenu la lib Ã  jour, fait dâ€™autres tests (1 par an) puis il y a 2 mois, la version 3.1.0 de request-ip est apparue.
Et quelle mise Ã  jour ! La librairie Ã©tait devenue 0-dependancy !
Sans mâ€™en rendre compte, je venais de proposer pas moins de 2 ans AVANT la 3.1.0 une amÃ©lioration dâ€™une librairy tÃ©lÃ©chargÃ©e plus de 500 000 fois par semaine !
VISIONNAIRE !</p>
<p>Bon. En thÃ©orie, jâ€™aurai pu me contenter dâ€™un simple pull request sur le projet principal mais Ã  la base, jâ€™ignorais la pertinance de mon idÃ©e.
Câ€™Ã©tait surtout un caprice de ma part de voir du code moche avec des micros dÃ©pendances de partout qui mâ€™a motivÃ©.</p>
<p>Aujourdâ€™hui il sâ€™agit de mon projet le plus tÃ©lÃ©chargÃ© (+4500 tÃ©lÃ©chargement au total) :p</p></div>
		</div>
		<footer class="tac mt6 astro-62YOCVTG">
			<a href="/projects" class="astro-62YOCVTG">
				<span data-hk="0-0" class="_button_1fbb5_1">Voir plus</span>
			</a>
		</footer>
		<footer data-hk="0-0" class="_footer_knfx6_1">Â© <!--#-->2022<!--/--> <a href="https://github.com/benevolarX">@benevolarX (auffret)</a><small class="_byline_knfx6_9">ğŸš€ gÃ©nÃ©rÃ© par Astro</small></footer>
	</body></html>